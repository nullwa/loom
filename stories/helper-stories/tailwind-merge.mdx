import { Meta, Markdown } from '@storybook/addon-docs/blocks'

<Meta title='helpers/tailwind-merge' />

# tailwind-merge

A utility function that wraps **`twMerge`** and **`class-variance-authority (cx)`**  
to ensure Tailwind classes are merged and deduplicated correctly.

It also re-exports `cva` and `VariantProps` from **class-variance-authority** for defining styled variants.

## API

### `tm`

```ts
tm(...inputs: ClassValue[]): string
```

- **`inputs`**: One or more class values (string, array, object).
- **Returns**: A single string with Tailwind classes merged and deduplicated.

### `cva`

```ts
cva(base?: ClassValue, options?: {
  variants?: Record<string, Record<string, ClassValue>>
  defaultVariants?: Record<string, string>
}): (...args: any[]) => string
```

- Used to define **variant-based class utilities**.
- Works seamlessly with `tm` for Tailwind merging.

### `VariantProps`

```ts
type VariantProps<T> = ExtractPropsFromCVA<T>
```

- Extracts TypeScript props from a `cva` function.
- Ensures your components get proper type inference for variants.

## Examples

#### <b>Example: Basic Merge</b>

```tsx
import { tm } from '@/utils/tm'

const Button = () => {
  return <button className={tm('px-4 py-2 bg-blue-500', 'bg-red-500')}>Click Me</button>
}
```

➡️ The resulting class will be:

```
"px-4 py-2 bg-red-500"
```

(`bg-blue-500` is removed since `bg-red-500` overrides it)

#### <b>Example: Using CVA</b>

```tsx
import { cva, VariantProps, tm } from '@/utils/tm'

const button = cva('px-4 py-2 rounded font-medium', {
  variants: {
    intent: {
      primary: 'bg-blue-500 text-white',
      secondary: 'bg-gray-200 text-black',
    },
    size: {
      sm: 'text-sm',
      lg: 'text-lg',
    },
  },
  defaultVariants: {
    intent: 'primary',
    size: 'sm',
  },
})

type ButtonProps = VariantProps<typeof button>

const Button = ({ intent, size }: ButtonProps) => {
  return <button className={tm(button({ intent, size }))}>Click</button>
}
```

✅ This gives **typed props** (`intent`, `size`) and automatic class merging.

## Best Practices

1. Always wrap your conditional classes with `tm` to avoid duplication.
2. Use `cva` when your component has **variants** (e.g., size, intent, theme).
3. Extract `VariantProps<typeof cvaFn>` to type your component props automatically.

## Why?

- **`twMerge`** ensures only the last conflicting Tailwind class is kept.
- **`cva`** adds structured, composable variants for your components.
- **`tm`** glues them together for **clean, predictable styling**.
