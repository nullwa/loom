import { Meta, Markdown } from '@storybook/addon-docs/blocks'

<Meta title='helpers/cx-tm' />

# cx & tm

<p>
  Utilities for handling Tailwind CSS class names more effectively. They simplify class merging and provide better IntelliSense support when working with
  Tailwind.
</p>

---

## Features

- ðŸŽ¨ **Custom Tailwind Merge**: Extend `tailwind-merge` with project-specific tokens
- ðŸ§¹ **Class Deduplication**: Automatically resolves conflicting Tailwind classes
- âœ¨ **Better IntelliSense**: `tm` helps sort and preserve class objects for IDE support
- ðŸ›  **Reusable**: Works across components and utilities

---

## Installation

```tsx
// Copy the utilities into your project
import { cx, tm } from '@/utils/classnames'
```

---

## API Reference

### **`cx`**

```ts
const className = cx('px-2', 'py-1', 'bg-blue-500', 'bg-red-500')
// => 'px-2 py-1 bg-red-500'
```

<Markdown className='w-full'>
  {`
| Parameter   | Type         | Description |
|-------------|--------------|-------------|
| \`...classNames\` | \`string\` | Any number of Tailwind class strings |
  `}
</Markdown>

**Extension Example**

```ts
export const cx = extendTailwindMerge({
  extend: {
    theme: {
      text: ['display-xs', 'display-sm', 'display-md', 'display-lg', 'display-xl', 'display-2xl'],
    },
  },
})
```

This allows merging custom tokens like `display-sm` or `display-lg` consistently.

---

### **`tm`**

```ts
function tm<T extends Record<string, string | number | Record<string, any>>>(classes: T): T
```

A no-op helper function.
Its purpose is **IDE support for Tailwind IntelliSense**, making it easier to work with style objects.

**Example**

```ts
const buttonStyles = tm({
  base: 'inline-flex items-center justify-center rounded-md',
  primary: 'bg-blue-500 text-white hover:bg-blue-600',
  secondary: 'bg-gray-200 text-gray-800 hover:bg-gray-300',
})
```

âœ… IntelliSense will now auto-complete Tailwind classes inside the `tm({})` object.

## Usage Examples

#### **Merging Classes**

```tsx
function Button({ primary }: { primary?: boolean }) {
  return <button className={cx('px-4 py-2 rounded', primary ? 'bg-blue-500 text-white' : 'bg-gray-200 text-black')}>Click me</button>
}
```

#### **With Style Objects (`tm`)**

```tsx
const badgeStyles = tm({
  base: 'inline-block rounded-full px-2 py-1 text-xs font-semibold',
  success: 'bg-green-100 text-green-800',
  error: 'bg-red-100 text-red-800',
  warning: 'bg-yellow-100 text-yellow-800',
})

function Badge({ variant = 'success' }: { variant?: keyof typeof badgeStyles }) {
  return <span className={cx(badgeStyles.base, badgeStyles[variant])}>Badge</span>
}
```

## Best Practices

1. âœ… Use `cx` for merging classes in components.
2. âœ… Use `tm` for defining large style objects with IntelliSense.
3. ðŸš« Avoid nesting `tm` inside `cx` â€” they serve different purposes.
4. ðŸ”§ Extend `cx` with your **design tokens** (`display-*`, custom spacing, etc.) to ensure consistency.

## Troubleshooting

- **Classes not merging correctly**: Check if theyâ€™re part of your Tailwind config; if not, extend `cx`.
- **No IntelliSense inside `tm`**: Ensure your IDE Tailwind plugin is enabled.
- **Unexpected class override**: Remember, `cx` resolves conflicts based on Tailwindâ€™s rule priority.
